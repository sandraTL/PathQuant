
# PathQuant Vignette 
###author : Sandra Therrien-Laperrière
###date : 21 avril 2016

##Description  

PathQuant aims to quantify associations between gene-metabolite associations in
a selected KEGG pathway.
To do so, PathQuant calculates distances, which are define as the number of 
reaction separating a gene (represented as the edge of the pathway) and a 
metabolite (node of the pathway) We developped functions to give the user tools 
to calculate dsitance for associatiosn data, but also to be able to compare the 
distance of any gene-metabolite pairs.


## Info 

The example data used is from the Shin & al Study [1]. 'associatedGeneMetaDF'
are the gene-metabolite associations reported in this study and 
'completeMetaboliteDF' are all the measured metabolite of this study.

## Fonctions

```{r}
library("PathQuant")
```
###getDistanceAsso Function 
This function enables the user to select the KEGG pathway on which the associations
will be mapped to calculate the shortest distance.The 
output of the function is a dataframe with the calculated distances. An infinited distance (Inf) means that both gene and metabolite are on the map but no path exist between them.
If a distance is NaN, it means neither the gene or the metabolite (or both) are 
on the selected pathway.

####Arguments : 
    pathwayId: KEGG Id of selected pathway.
    association : Dataframe with 2 columns, where each line reprensents an
associations. First column are genes and the sencond column are
metabolites. Only use KEGG Ids.
    Options :
    ordered : boolean, orders the dataframe by distance columns (ascendent).

```{r, size=12}
df <- getDistanceAsso("hsa01100", shinAndAlDF, F)
df[1:10,]

```

###getDistanceAll Function 
This function calculates the distribution of distances between a gene and all
measured metabolite, highlithing the distance of its associated metabolites.
It enables the comparison of distances between de associated metabolite vs. non associated measured metabolites.


####Arguments : 
    pathwayId: KEGG Id of selected pathway.
    completeGeneDF :is a dataframe of 1 column with the KEGG Ids of
                           all measured genes.
    completeMetaboliteDF : is a dataframe of 1 column with the KEGG Ids of
                           all measured metabolites.


```{r, size=12}
df1 <- getDistanceAll("hsa01100", completeGeneDF, completeMetaboDF)
df1[1:5,]
```


###distributionGene Function
Function calculating shortest distance between a selected gene and all measured metabolites.The plot is depicted as frequency bars, which represent the number of metabolites at a given distance for the selected gene. Frequency bars are shown in grey for metabolites that are not associated with the selected gene and in red if there is at least one metabolite associated with this gene.


####Arguments : 
    pathwayId: KEGG Id of selected pathway.
    associatedGeneMetaDF : is a dataFrame with 2 columns. Where each line 
                            reprensents an associations with the first column as
                            gene KEGG Ids and the sencond column as metabolite
                            KEGG Ids.
    completeMetaboliteDF : is a dataframe of 1 column with the KEGG Ids of
                           all measured metabolites.
    gene : KEGG ID of the selected gene used to calculates all distances from.

```{r, fig.width=7,fig.height=4}
distributionGene("hsa01100", shinAndAlDF, completeMetaboDF, "hsa:1373")
distributionGene("hsa01100", shinAndAlDF, completeMetaboDF, "hsa:27165")
```
![CPS1](https://github.com/sandraTL/PathQuant/blob/master/vignettes/CPS1.png)
![GLS2](https://github.com/sandraTL/PathQuant/blob/master/vignettes/GLS2.png)

###heatmapAsso Function 
 Function that output a heatmap to visualize distance calculated between every gene-metabolite associations in input.
Heatmap of distances calculated between associated genes-metabolites reported by Shin et al.. Columns represent genes and rows represent metabolites. The calculated distance is shown in each cell with the corresponding color code (from red - closest; to yellow - farthest). The distance calculated for the 30 gene-metabolite associations are reported in cells with a thick black border. Inf = infinite value, which mean that there is no known path between gene and metabolite.

####Arguments : 
    pathwayId: KEGG Id of selected pathway.
    association :  is a dataFrame with 2 columns. Where each line 
                            reprensents an associations with the first column as
                            gene KEGG Ids and the sencond column as metabolite
                            KEGG Ids.

```{r, fig.width=7,fig.height=4}
heatmapAsso("hsa01100", shinAndAlDF)
```

![Heatmap](https://github.com/sandraTL/PathQuant/blob/master/vignettes/heatmapAsso1.png)


###permutationTest Function
Statistical permutation test function to asses the relevance of associated
gene-metabolite pairs vs. randomly selected pairs.
This function produces permutation sets by creating random gene-metabolite
associations and calcuates the median distance of every permutation to output :
1) 'medians' 2) 'histogram' 3) 'pvalue'. 
Replacing gene : random gene is choosed within the set of measured genes catalysing +/- 1 reaction(s). Gene catalysing 1 reaction are repalce by a gene 
calatysing 1 reaction from set of measured genes 'completeGeneDF'.
Metabolites are replaced by any of the measured metabolites: 'completeMetaboDF'.
 
####Arguments : 
    pathwayId: KEGG Id of selected pathway.
    association:  is a dataFrame with 2 columns. Where each line 
                            reprensents an associations with the first column                              as gene KEGG Ids and the sencond column as                                     metabolite KEGG Ids.
    completeGeneDF: is a dataframe of 1 column with the KEGG Ids of
                           all measured genes.
    completeMetaboliteDF: is a dataframe of 1 column with the KEGG Ids of
                           all measured metabolites.
    permutation : number of permutation. 
    output : 'medians', 'histogram', 'pvalue'.                           


```{r, eval= F}
p <- permutationTest(metabolismOverviewMapKEGGId, shinAndAlDF,
                         completeGeneDF, completeMetaboDF, 1000, "medians")
```

![Histogram](https://github.com/sandraTL/PathQuant/blob/master/vignettes/permutations1000.png)



1. Shin, So-Youn et al. “An Atlas of Genetic Influences on Human Blood 
Metabolites.” Nature genetics 46.6 (2014): 543–550. PMC.








